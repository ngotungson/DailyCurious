function NP4EWidget(){this.scripts="",this.url="",this.numWidget="",this.results=[],this.sponsoredResults=[],this.searchComplete="",this.windowLoad=!1,this.sponsoredIds=[],this.timeoutForAjax=2e4,this.searchURL="https://gspplatform.cfemedia.com/pe/productsearch/widget",this.pwInit=function(){var e=this;e.scripts=document.getElementsByTagName("script"),e.url=e.scripts[e.scripts.length-1].src,e.numWidget=e.pwGetParameterByName("numresults",e.url),window.jQuery(window).on("load",function(){e.windowLoad=!0,e.pwExecuteSearch(e)})},this.pwCallServer=function(e,t,s){var r=window.jQuery.Deferred();return window.jQuery.ajax({url:e.searchURL,type:"POST",data:e.pwBuildAjaxRequest(e,t),contentType:"application/json; charset=utf-8",cache:!0,crossDomain:!0,dataType:s,timeout:e.timeoutForAjax,success:function(t){r.resolve(e,t)},error:function(){t?r.resolve(e,{ids:[],html:""}):r.resolve(e,"")}}),r.promise()},this.pwSetSponsoredVariables=function(e,t){e.sponsoredIds=t.ids,""!=t.html?e.sponsoredResults.push(e.pwFinishHTML(t.html,0)):e.sponsoredResults.push(t.html)},this.pwProcessResults=function(e,t){for(var s=0;s<e.numWidget/5;s++)""!=t?e.results.push(e.pwFinishHTML(t,s)):e.results.push("")},this.pwExecuteSearch=function(e){var t=window.jQuery.Deferred();e.searchComplete=t.promise(),e.pwCallServer(e,!0,"json").done(e.pwSetSponsoredVariables).then(function(){e.pwCallServer(e,!1,"text").done(e.pwProcessResults).then(function(){t.resolve()})})},this.pwDisplayHTML=function(e,t){window.jQuery(t).html(e)},this.pwHideProductDisplay=function(e){window.jQuery(e).parent().parent().css("display","none")},this.pwFinishHTML=function(e,t){var s=e.split("\x3c!-- PRODUCT --\x3e");return s[5*t]+s[5*t+1]+s[5*t+2]+s[5*t+3]+s[5*t+4]},this.pwBuildAjaxRequest=function(e,t){return'{"view": "'+e.pwGetParameterByName("view",e.url)+'","offset": "'+e.pwGetParameterByName("offset",e.url)+'","imagewidth": "'+e.pwGetParameterByName("imagewidth",e.url)+'","imageheight": "'+e.pwGetParameterByName("imageheight",e.url)+'","numWidget": "'+e.pwGetParameterByName("numresults",e.url)+'","categories": '+e.pwCleanCategories(e.pwGetParameterByName("categories",e.url))+',"sponsored":'+t+', "sponsoredIds":'+e.pwCleanCategories(e.sponsoredIds.toString())+',"brand": "'+e.pwGetBrand()+'"}'},this.pwGetBrand=function(){switch(document.location.host.replace(/(stage|www)\.|\.(com|test)/gi,"")){case"plantengineering":return"pe";case"csemag":return"cse";case"oilandgaseng":return"oge";case"controleng":default:return"ce"}},this.pwCleanCategories=function(e){null!=e&&""!=e||(e="");var t="[";if(""!=e){e=e.split(",");for(var s=0;s<e.length;s++)t+='"'+e[s]+'"',s+1<e.length&&(t+=",")}return t+="]"},this.pwGetParameterByName=function(e,t){var s=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return s?s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"":null}}var np4eWidget=new NP4EWidget;np4eWidget.pwInit(),window.np4eWidget=np4eWidget;